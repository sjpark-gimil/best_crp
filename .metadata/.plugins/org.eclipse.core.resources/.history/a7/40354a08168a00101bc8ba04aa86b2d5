#include "main.h"
#include "gpio.h"
#include "usart.h"
#include <string.h>
#include <stdio.h>

void SystemClock_Config(void);
extern UART_HandleTypeDef huart2;

static void tx(const char *s) {
  (void)HAL_UART_Transmit(&huart2, (uint8_t*)s, (uint16_t)strlen(s), 200);
}

int main(void)
{
  HAL_Init();
  SystemClock_Config();
  MX_GPIO_Init();
  MX_USART2_UART_Init();   /* make sure baud matches what youâ€™re testing */

  uint32_t n = 0;
  for (;;)
  {
    char line[32];
    snprintf(line, sizeof line, "PING %lu\r\n", (unsigned long)++n);
    tx(line);
    HAL_Delay(1000);
  }
}

void Error_Handler(void){ __disable_irq(); while(1){} }

